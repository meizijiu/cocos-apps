{"version":3,"sources":["file:///Users/mzwine/Codes/other/cocos-apps/watermelon/assets/GameScene/ui/touchNodeCtrl.ts"],"names":["_decorator","Component","Node","Vec3","GameSceneCtrl","ccclass","property","TouchNodeCtrl","onEnable","node","on","EventType","TOUCH_MOVE","onTouchMove","TOUCH_END","onTouchEnd","TOUCH_CANCEL","onDisable","off","event","gameSceneCtrl","curFruit","befforeOffset","getDelta","a","Math","PI","b","x0","x","y0","y","x1","cos","sin","z1","afferOffset","offsetCurFruit","position","add","dropFruit"],"mappings":";;;;;;;;;;;;;;;;;;;;AAASA,MAAAA,U,OAAAA,U;AAAYC,MAAAA,S,OAAAA,S;AAAWC,MAAAA,I,OAAAA,I;AAAkBC,MAAAA,I,OAAAA,I;;AACzCC,MAAAA,a,kBAAAA,a;;;;;;;OACH;AAAEC,QAAAA,OAAF;AAAWC,QAAAA;AAAX,O,GAAwBN,U;;+BAGjBO,a,WADZF,OAAO,CAAC,eAAD,C,UASLC,QAAQ;AAAA;AAAA,yC,oCATX,MACaC,aADb,SACmCN,SADnC,CAC6C;AAAA;AAAA;;AAAA;AAAA;;AAY3CO,QAAAA,QAAQ,GAAG;AACT;AACA,eAAKC,IAAL,CAAUC,EAAV,CAAaR,IAAI,CAACS,SAAL,CAAeC,UAA5B,EAAwC,KAAKC,WAA7C,EAA0D,IAA1D;AACA,eAAKJ,IAAL,CAAUC,EAAV,CAAaR,IAAI,CAACS,SAAL,CAAeG,SAA5B,EAAuC,KAAKC,UAA5C,EAAwD,IAAxD;AACA,eAAKN,IAAL,CAAUC,EAAV,CAAaR,IAAI,CAACS,SAAL,CAAeK,YAA5B,EAA0C,KAAKD,UAA/C,EAA2D,IAA3D;AACD;;AAEDE,QAAAA,SAAS,GAAG;AACV;AACA,eAAKR,IAAL,CAAUS,GAAV,CAAchB,IAAI,CAACS,SAAL,CAAeC,UAA7B,EAAyC,KAAKC,WAA9C,EAA2D,IAA3D;AACA,eAAKJ,IAAL,CAAUS,GAAV,CAAchB,IAAI,CAACS,SAAL,CAAeG,SAA7B,EAAwC,KAAKC,UAA7C,EAAyD,IAAzD;AACA,eAAKN,IAAL,CAAUS,GAAV,CAAchB,IAAI,CAACS,SAAL,CAAeK,YAA7B,EAA2C,KAAKD,UAAhD,EAA4D,IAA5D;AACD,SAxB0C,CA0B3C;AAEA;;;AAEAF,QAAAA,WAAW,CAACM,KAAD,EAAoB;AAC7B,cAAI,CAAC,KAAKC,aAAL,CAAmBC,QAAxB,EACE;AAEF,cAAIC,aAAmB,GAAGH,KAAK,CAACI,QAAN,EAA1B,CAJ6B,CAK7B;;AAGA,cAAIC,CAAC,GAAG,KAAK,GAAL,GAAWC,IAAI,CAACC,EAAxB;AACA,cAAIC,CAAC,GAAG,KAAK,GAAL,GAAWF,IAAI,CAACC,EAAxB;AACA,cAAIE,EAAE,GAAGN,aAAa,CAACO,CAAvB;AACA,cAAIC,EAAE,GAAGR,aAAa,CAACS,CAAvB;AACA,cAAIC,EAAE,GAAGJ,EAAE,GAAGH,IAAI,CAACQ,GAAL,CAAST,CAAT,CAAL,GAAmBM,EAAE,GAAGL,IAAI,CAACS,GAAL,CAASV,CAAT,CAAjC;AACA,cAAIW,EAAE,GAAG,CAACP,EAAD,GAAMH,IAAI,CAACQ,GAAL,CAASN,CAAT,CAAN,GAAoB,IAApB,GAA2BG,EAAE,GAAGL,IAAI,CAACS,GAAL,CAASP,CAAT,CAAL,GAAmB,IAAvD;AACA,cAAIS,WAAW,GAAG,IAAIjC,IAAJ,CAAS6B,EAAE,GAAG,IAAd,EAAoB,CAApB,EAAuBG,EAAE,GAAG,IAA5B,CAAlB;AAEA,eAAKf,aAAL,CAAmBiB,cAAnB,CAAkCD,WAAlC;AAEA,cAAIE,QAAQ,GAAG,IAAInC,IAAJ,CAAS,KAAKiB,aAAL,CAAmBC,QAAnB,CAA4BiB,QAArC,CAAf;AACAA,UAAAA,QAAQ,CAACC,GAAT,CAAaH,WAAb;AAIA,eAAKhB,aAAL,CAAmBC,QAAnB,CAA4BiB,QAA5B,GAAuCA,QAAvC;AACD;;AAEDvB,QAAAA,UAAU,GAAG;AACX,cAAI,CAAC,KAAKK,aAAL,CAAmBC,QAAxB,EACE;AAEF,eAAKD,aAAL,CAAmBoB,SAAnB;AACD,SA7D0C,CAgE3C;AACA;AACA;;;AAlE2C,O;;;;;iBASL,I","sourcesContent":["import { _decorator, Component, Node, EventTouch, Vec3, Vec2 } from 'cc';\nimport { GameSceneCtrl } from '../GameSceneCtrl';\nconst { ccclass, property } = _decorator;\n\n@ccclass('TouchNodeCtrl')\nexport class TouchNodeCtrl extends Component {\n  /* class member could be defined like this */\n  // dummy = '';\n\n  /* use `property` decorator if your want the member to be serializable */\n  // @property\n  // serializableDummy = 0;\n\n  @property(GameSceneCtrl)\n  public gameSceneCtrl: GameSceneCtrl = null;\n\n\n  onEnable() {\n    // this.node.on(Node.EventType.TOUCH_START, this.onTouchBegin, this);\n    this.node.on(Node.EventType.TOUCH_MOVE, this.onTouchMove, this);\n    this.node.on(Node.EventType.TOUCH_END, this.onTouchEnd, this);\n    this.node.on(Node.EventType.TOUCH_CANCEL, this.onTouchEnd, this);\n  }\n\n  onDisable() {\n    // this.node.off(Node.EventType.TOUCH_START, this.onTouchBegin, this);\n    this.node.off(Node.EventType.TOUCH_MOVE, this.onTouchMove, this);\n    this.node.off(Node.EventType.TOUCH_END, this.onTouchEnd, this);\n    this.node.off(Node.EventType.TOUCH_CANCEL, this.onTouchEnd, this);\n  }\n\n  // onTouchBegin(event: EventTouch) {\n\n  // }\n\n  onTouchMove(event: EventTouch) {\n    if (!this.gameSceneCtrl.curFruit)\n      return;\n\n    let befforeOffset: Vec2 = event.getDelta();\n    //todo 转换offset\n\n\n    let a = 18 / 180 * Math.PI;\n    let b = 23 / 180 * Math.PI;\n    let x0 = befforeOffset.x;\n    let y0 = befforeOffset.y;\n    let x1 = x0 * Math.cos(a) - y0 * Math.sin(a);\n    let z1 = -x0 * Math.cos(b) * 0.74 - y0 * Math.sin(b) * 0.74;\n    let afferOffset = new Vec3(x1 * 0.07, 0, z1 * 0.07);\n\n    this.gameSceneCtrl.offsetCurFruit(afferOffset);\n\n    let position = new Vec3(this.gameSceneCtrl.curFruit.position);\n    position.add(afferOffset);\n\n\n\n    this.gameSceneCtrl.curFruit.position = position;\n  }\n\n  onTouchEnd() {\n    if (!this.gameSceneCtrl.curFruit)\n      return;\n\n    this.gameSceneCtrl.dropFruit();\n  }\n\n\n  // update (deltaTime: number) {\n  //     // Your update function goes here.\n  // }\n}\n"]}